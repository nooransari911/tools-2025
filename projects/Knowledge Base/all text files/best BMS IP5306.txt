So, this battery charging module is way better than a regular TP 4056 module as it got faster charging speed, built-in 5V booster, built-in fuel gauge indicator, got way better efficiency and the most important part, it can communicate with your microcontroller board via I2C to provide the relevant battery information. So, this module is based on the IP5306 IC which is not just a battery charging IC but it's a complete BMS or we can say battery management system. Now you would ask why we designed this model when the similar module exist in the market. Well, the modules which exist in the market got two issues. First being the onboard battery level indicator LEDs are always on and we cannot turn it off and these LEDs consumes unnecessary power.

Secondly, we don't get access to the I2C pin due to which we cannot access the data from the BMS which we can later use it in our projects. So to solve those two issue, I designed myself a dedicated BMS based on the IP5306 model which I can later use it in any of my project and make it run on battery quite easily and this video is dedicated to this module only and I'll discuss how we made it and how to use this module. So now let's move ahead and have a look over the schematic of this module. Okay, so here is the complete schematic of our IP5306based PMS and this is the main IC and all the passive components around it are kind of meant to be added to make this IC run perfectly fine. Now let me just tell you what kind of extra features we have added.

So first of all under the LED section we haven't added the LED uh here but rather we have added the SL and SDA pin which are exposed by the header pins somewhere here. So we can connect the I2C pins of the microcontroller at this particular point and we can communicate with this IC via I2C protocol. After that uh here is the uh what we can say inbuilt power key pressing which we can turn on and off this EMS. But along with that we also added this extra EN pin which is again exposed here at the header pin. Now we can connect external button in our project in case this inbuilt button is not accessible or not convenient to click in your project.

So you can add the extra button or the external button to power on and off your project. Thirdly here as you can see we have added the external fuel gauge indicator as well which is again exposed to this particular pin. But the question is this IC already has the inbuilt fuel gauge. So why external? Well, because uh this IC can give you four level of battery percentage you can say 25%, 50%, 75% and the 100%.

We cannot get the in between values. But if you want to get the in between values, you can use this fuel gauge spin to get kind of uh in between values. This is optional. Uh this is kind of a feature which is added but you can ignore it as well if you are okay with this particular uh full level of battery percentage indication. After that here under the header pin out we have a dedicated ground pin for everything like for V out and ground V in and ground and battery and ground.

So you do not have to merge any of the ground pins. We have enough ground pin for adding input or taking the output everything using jumper wires as well. So this kind of a complete schematic and below that we have a power LED which is not exactly a power LED but a charging indication LED and also we have a jumper here. So if we join connect this jumper then only this activated. So what is this?

So whenever you uh put this battery on charging the LED on board will turn on if the jumper is connected just to indicate that the battery is in charging condition. Uh if if you remove the jumper the LED will not turn on. And why we added a jumper because this IC already has the inbuilt indication about whether the battery is in charging condition or discharging condition. So you can get the data via I2C to your microcontroller and later you can you know display the data or process the data or whatever you want. So in case if you don't want the external LED you can remove the jumper. or the LED won't work.

If you want the dedicated LED for charging, you can shoulder the jumper and this will work. This is kind of a complete schematic and let me just show you the PCB design for it. So, this is the final PCB and we kind of made this PCB inspired from the SHA boards. As you can see, the headers of this module is inspired from the shiao boards from seed studio. So, using this we can not only add the male or female headers using this two hole but uh if I show you the bottom part uh let me just uh go to the bottom.

As you can see the bottom part is completely blank and here we can shoulder this complete module on the surface as well. So it can be used and on a surface mount component or a through hole component as well. Both ways you can use it's totally depend on you and your project. So after designing the final PCB we later gave its order directly to PCB go. Now, PCB Gogo is one of the biggest PCB manufacturer in China that is working since 2015.

And I also got a chance to visit their factory in Shenzhen in 2023. It's really huge and they are processing around 3,000 orders per day. And now ordering PCBs on PCB go very simple. You just need to upload the Gerber file of your PCB project. Select the number of PCBs and color masking and later select the shipping option as per your location and after that your design will be reviewed for any error and later after reviewing you can pay for your order and get it delivered at your doorstep.

Now the PCB comes safely in the vacuum packaging and the PCB quality feels really premium. Now, currently they are having an amazing offer where you can get $25 worth PCB at just a dollar for all the new users and they're also offering free shipping in North America and Europe. So just click the link mentioned in the description and get your PCBs from PCB go. So after getting the PCBs, we started adding the shoulder paste on it and later put the surface mount components on it one by one. Later after putting them all we let it bake on the heat bed for a while and after some time our PCB panel was ready with all the components and later we broke the panel into single PCB unit and here is our final IP5306based BMS model that works over I2C.

So now it's time to test it out. So for testing we first added the male headers to this module and later we connected our module with battery and the ESP32 board according to this connection diagram. Now let's jump onto the computer and start the coding part. Okay. So on GitHub I found this repository which has the code IP5306.ino.

Well, this is an amazing code because this doesn't require any kind of external library particularly for the IP 5306 IC. Everything is inside this main code only. We are just using one single library which is wire.h is responsible for I2C. Uh so I'll click on raw and later I'll open up Ardino ID and paste that code here. Okay.

Okay. So now what I'll do I'll just select the right board and comport. The board is do it get kit v1 comp port is selected. Let's just hit the upload button. And after the code gets uploaded.

Let's just test out is this BMS working or I2C or not. Okay. So the code is successfully uploaded. I'll open the serial monitor. Let's just maximize this and let's just press press the reset button.

Okay. So I'll stop the auto scroll. And here as you can see it says uh IP 5306 get bit fail. So it is not able to read any kind of data from this particular IC because right now this is in shutdown position. So I already connected the battery and the I2C and connected but this module is in shutdown condition.

We need to power it up to make it work. So I'll just press and hold this power button and uh release it. Okay. So now as you can see it says battery state discharging and battery available is 75%. Now we are not getting any kind of a bit fail error.

So if I reset this board right now, now as you can see it can read all the parameters. Okay. So these are the parameters uh of this IC which has been which has been read by uh the ES32 board. So this means that it is working over I2C and as this is there's no load connected right now. It automatically shut down after a couple of second as you can see.

Now now it also again says a bit failed. Okay. So now if I power it up let's just check if we are getting the 5 volt at the V out or not. Okay. and all just press and hold this button and release it. Okay, it's powered on right now.

So let us check through the multimeter if we are getting the V out 5 volt or not. So yes, this is the V out pins and as you can see I'm getting the 5V output and after a couple of second uh this will drop down. Let's just wait for that moment as well. Okay, so as you can see the voltage dropped out as no load is connected to it. So with this we can be sure that this IP5306 I2C model is working perfectly fine and till now we haven't connected any load with it.

So now let's try to connect any load and test out this module. So here as a load we have connected this shiao board along with the max amplifier and a speaker. So I have powered the shiao board with the V out pin of this IP5306 module. So as of now it is powered off. So it's nothing is working but as soon as we powered it up uh it should play a beep sound on it.

So let us try it out. So I'll just press and hold this and release it. Okay, as you can see it started working and even on the serial monitor we started getting the data uh as discharging and with the battery level of 25 to 50% it's fluctuating because it is somewhere between 25 and 50% that's why but and uh if I doubleclick it this will power everything off and on the serial monitor we can see it started getting the fail from reading the register of the IC. Okay, so that's the uh programming. So like with a with a single press you can power it up and with the double press you can power it off.

Okay. And also this module shows whether the battery is being charging or not. So here as you can see as soon as I applied the 5V supply to the Vin pin of this module the blue light turned on which means the battery is currently in charging position. And on the CV monitor we can see that the battery state changed to charging and it's fluctuating somewhere between 75 and 100%. So yeah, we can also detect whether it the battery is currently charging or we can say discharging all through the uh I2S pins of this DMS.

Now this model also got one really useful feature using which you can not only use it with the 3.3 volt logic level microcontroller like an ESP32 board, but you can also use it with the 5V logic level controller like an Arduino board. So for testing here I'm using the Arduino Mega board and the BMS module and the battery. And this time we made the connection according to this connection diagram. And as you can see the logic pin is given 5 volt this time. Now after making the connection it's time for the code.

Okay. So here is the previous code that we used in a ESP32 board. Now the thing is uh the serial print f function not natively supported uh in the Arduino board. So if we compile it we will end up with a lot of errors. So we can definitely change it like modify the code to make it work.

And if you don't want to modify, well, what you can do, you can download this library whose link I'll be attaching in the description. After downloading the zip file and installing the library, uh you'll get an example code. So, under files, examples into IP5306, IP5306 ESP32 test. This is the example code, but this will work for Ardino board as well. So, uh after getting the example code, you just need to upload into the Arduino board.

And uh let's see how this works. So, yeah, I have uploaded it. And if I clear this up uh currently uh as you can see it shows power source battery charging discharging and battery level 100%. Now this is not the actual reading means if even if I remove the I2C connection it will show the exact same data. So this is not the correct data.

So how can we be sure that it is working or not? So first of all I'll make the I2C connection back and when I power this uh module up by pressing and holding the power button and releasing it. Now as you can see the actual battery percentage which is 50 appeared here. So we can be sure that this is now communicating with our microcontroller uh board. And in case if I add the external power source the VIN pin as you can see the blue light got turned on which means it is in charging condition.

And here as you can see the power source uh changed to Vin. Earlier it was battery and now it changed to Vin. So we have provided the power from vin and uh hence it is charging and we are getting the data on the serial monitor that means it is successfully able to communicate to the Arduino board. So it's working on 5V logic level as well. Now after testing it's working with both Arduino and ESP board.

Now let's test out its current capability. Now as per my knowledge the GSM and GPRS boards are the most power hungry devices as those module sometimes need at least 2 ampers of peak current for its proper working. So if our BMS module can run those power hungry modes, well then it can run any of your IoT project. So now let's test it out. Okay.

So here is the 4G module which is powered by this I2S BMS module which is connected with this particular battery. It is not powered with any other sources and I have connected this module with the ESP32 board YUR communication protocol and I have connected this I2C module Y I2C communication protocol and as you can see all the lights are turned on means it's working completely on this particular power source. And here I have uploaded a code. Let me just reset this code. And here I uploaded a code of HTTP client in which it will initialize all the uh initialize the model with all the 80 commands.

And after that it will request from one website and get the response here. The response will be tiny GSM. So let me just turn off the auto call once we get the response to let you see that uh result. Okay. So now HTTP get.

Okay. So now it will be HTTP read. Okay. Now we'll get the response. Okay.

So here's the response. Tiny DSM. So as you can see this model is perfectly working based on this I2C model. So means it is able to source at least like 2 ampers of current to this model then only it is working. Okay.

And after that as you can see if I scroll it is showing the battery percentage and everything. So yes this model is capable enough to run the uh power hungry modules like the 4G models or the GSM models. One more thing uh the benefit of having the I2C communication with this model is we can program it as well. Programming means let me just show you the setup of this. Okay.

So here in the void setup I have turned both the values one and with the help of which I have set this module to never power off. Okay. So before we tested that when there no load is connected when the load is very less it automatically powers off. Okay. But with this two line of code uh I have set the register that it will never turn off the model even if the load is not connected.

And similarly you can program a lot of things which is mention mentioned here. So everything is mentioned like by providing value zero we can change the like full stop voltage as well like 4.14 voltage the battery will stop charging if you set it to one at 4.17 it will stop charging and so on and so forth. So you can modify all the resistors and can customize this particular model as per your requirement. This is coolest part or the coolest feature of this I2C based IP5306 BMS. So that's the benefit of having the I2C communication in the BMS.

Like we are not just monitoring the battery percentage rather we can also get to know whether the battery is being charged or not. We also get to know when the battery is completely charged. We can also modify the parameters of the IC and customize is based on our projects and later we can also send all those data to our cloud in our IoT based projects. So I completely like this BMS model and in case if you know some better BMS model which has these or any more features well do share me in the comment section. I would love to test that out and yeah that was it about this video.

I hope you like the concept and idea about this model. if it so well a like will be really appreciated as this will let the YouTube algorithm know that this video was really good and worth watching and yeah with that being said I'm just ending this video here and now just wait for my next video until then explore learn share with me techie It's a mess. [Music]