<!DOCTYPE html>
<html lang="en" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="page-title">Document Reader</title>
    <!-- Tailwind CSS via CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Marked.js for Markdown parsing -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/5.1.1/marked.min.js"></script>
    <!-- Custom Font and Inline Tailwind Configuration -->
    <style>
        /* Import Google Font */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');

        /* Set base font */
        body {
            font-family: 'Inter', sans-serif;
        }

        /* Custom scrollbar for a modern look */
        ::-webkit-scrollbar {
            width: 10px;
        }
        ::-webkit-scrollbar-track {
            background: #000;
        }
        ::-webkit-scrollbar-thumb {
            background: rgb(60, 60, 60);
            border-radius: 5px;
            border: 2px solid #000;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #67e8f9;
        }

        /* Markdown-specific styling - More generous spacing and coherent color scheme */
        .markdown-content h1 {
            font-size: 3.5rem;
            font-weight: 700;
            color: #00ffff; /* Pure cyan */
            margin-bottom: 2rem;
            margin-top: 4.8rem;
            line-height: 1.1;
        }
        .markdown-content h1:first-child {
            margin-top: 0; /* Remove top margin for first heading */
        }
        .markdown-content h2 {
            font-size: 2.75rem;
            font-weight: 700;
            color: rgb(255, 0, 80); /* Crimson */
            margin-bottom: 2rem;
            margin-top: 4.2rem;
            border-bottom: 3px solid #374151;
            padding-bottom: 1rem;
            line-height: 1.1;
        }
        .markdown-content h3 {
            font-size: 2rem;
            font-weight: 600;
            color: white;
            margin-bottom: 1.5rem;
            margin-top: 3.2rem;
            line-height: 1.2;
        }
        .markdown-content h4 {
            font-size: 1.5rem;
            font-weight: 600;
            color: #00ffff; /* Pure cyan */
            margin-bottom: 1.25rem;
            margin-top: 2.7rem;
            line-height: 1.2;
        }
        .markdown-content h5 {
            font-size: 1.25rem;
            font-weight: 600;
            color: white;
            margin-bottom: 1rem;
            margin-top: 2.2rem;
            line-height: 1.3;
        }
        .markdown-content h6 {
            font-size: 1.125rem;
            font-weight: 600;
            color: #00ffff; /* Pure cyan */
            margin-bottom: 1rem;
            margin-top: 2.2rem;
            line-height: 1.3;
        }
        .markdown-content p {
            color: #d1d5db;
            line-height: 1.8;
            margin-bottom: 2rem;
            font-size: 20px; /* 20px default font size */
        }
        .markdown-content code {
            background-color: rgba(255, 0, 80, 0.15);
            color: rgb(255, 0, 80); /* Crimson for inline code */
            padding: 0.375rem 0.625rem;
            border-radius: 0.375rem;
            font-size: 18px;
            font-family: 'Courier New', Courier, monospace;
            border: 1px solid rgba(255, 0, 80, 0.3);
        }
        .markdown-content pre {
            overflow-x: auto;
            font-size: 16px;
            color: #d1d5db;
            padding: 1.5rem;
            background-color: rgba(0, 0, 0, 0.8);
            border-radius: 0.5rem;
            margin-bottom: 2.5rem;
            margin-top: 1rem;
            border: 2px solid rgba(255, 0, 80, 0.3);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.3);
        }
        .markdown-content pre code {
            background-color: transparent;
            color: rgb(255, 0, 80); /* Crimson for code blocks */
            padding: 0;
            font-size: inherit;
            border: none;
            font-weight: 500;
        }
        .markdown-content blockquote {
            border-left: 4px solid #00ffff;
            padding: 1.5rem;
            color: #9ca3af;
            font-style: italic;
            margin: 2.5rem 0;
            background-color: rgba(0, 255, 255, 0.05);
            border-radius: 0.5rem;
            font-size: 18px;
        }
        .markdown-content ul, .markdown-content ol {
            margin-bottom: 2rem;
            padding-left: 2rem;
            font-size: 20px;
        }
        .markdown-content ul {
            list-style-type: disc;
        }
        .markdown-content ol {
            list-style-type: decimal;
        }
        .markdown-content li {
            color: #d1d5db;
            margin-bottom: 1rem;
            line-height: 1.7;
        }
        .markdown-content li ul, .markdown-content li ol {
            margin-top: 1rem;
            margin-bottom: 1rem;
        }
        .markdown-content hr {
            border: none;
            border-top: 2px solid #374151;
            margin: 4rem 0;
        }
        .markdown-content strong {
            color: rgb(255, 0, 80); /* Crimson for bold */
            font-weight: 700;
        }
        .markdown-content em {
            color: rgb(255, 0, 80); /* Crimson for italics */
            font-style: italic;
            font-weight: 500;
        }
        .markdown-content a {
            color: #00ffff;
            text-decoration: underline;
            text-underline-offset: 3px;
            text-decoration-thickness: 2px;
        }
        .markdown-content a:hover {
            color: rgb(255, 0, 80);
            text-decoration-color: rgb(255, 0, 80);
        }
        .markdown-content table {
            width: 100%;
            margin: 2.5rem 0;
            border-collapse: collapse;
            border: 2px solid #374151;
            border-radius: 0.5rem;
            overflow: hidden;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.3);
        }
        .markdown-content th, .markdown-content td {
            border: 1px solid #374151;
            padding: 1rem 1.25rem;
            text-align: left;
            font-size: 18px;
        }
        .markdown-content th {
            background-color: #1f2937;
            color: #00ffff; /* Pure cyan for headers */
            font-weight: 600;
        }
        .markdown-content td {
            color: #d1d5db;
        }
        .markdown-content img {
            max-width: 100%;
            height: auto;
            border-radius: 0.5rem;
            margin: 2rem 0;
            box-shadow: 0 8px 25px -5px rgba(0, 0, 0, 0.4);
        }

        /* Special styling for inline code in headings */
        .markdown-content h1 code,
        .markdown-content h2 code,
        .markdown-content h3 code,
        .markdown-content h4 code,
        .markdown-content h5 code,
        .markdown-content h6 code {
            background-color: rgba(255, 0, 80, 0.2);
            color: rgb(255, 0, 80);
            font-size: 0.85em;
            padding: 0.25rem 0.5rem;
            border: 1px solid rgba(255, 0, 80, 0.4);
        }

        /* Special styling for code blocks with headers */
        .code-block-header {
            background-color: #1f2937;
            color: rgb(255, 0, 80); /* Crimson for code block headers */
            padding: 0.75rem 1.25rem;
            font-size: 16px;
            font-weight: 600;
            border-top-left-radius: 0.5rem;
            border-top-right-radius: 0.5rem;
            border-bottom: 2px solid rgba(255, 0, 80, 0.3);
            margin-bottom: 0;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .markdown-content pre.has-header {
            border-top-left-radius: 0;
            border-top-right-radius: 0;
            margin-top: 0;
            border-top: none;
        }

        /* Loading animation */
        .loading-spinner {
            border: 4px solid #374151;
            border-top: 4px solid #67e8f9;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Error message styling */
        .error-message {
            @apply bg-red-900 border border-red-700 text-red-300 px-6 py-4 rounded-lg mb-6;
        }
    </style>
    <script>
        // Configure Tailwind to recognize our custom colors
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        crimson: 'rgb(255, 0, 80)',
                    }
                }
            }
        }
    </script>
</head>

<body class="bg-black text-gray-300 antialiased">

    <!-- Header Section -->
    <header class="text-center border-b border-gray-800 pb-8 pt-10 px-4">
        <h1 id="document-title" class="text-4xl md:text-5xl font-bold text-white mb-3">Loading Document...</h1>
        <p id="document-subtitle" class="text-lg text-cyan-400">Markdown Reader</p>
        <p class="text-gray-500 mt-4 text-sm">
            Location: Pune, Maharashtra, India | Time: <span id="time-display"></span>
        </p>

        <!-- File Input Controls -->
        <div class="mt-6 space-y-4">
            <div class="flex flex-col sm:flex-row gap-4 items-center justify-center">
                <input type="file" id="file-input" accept=".md,.markdown,.txt"
                       class="block w-full max-w-xs text-sm text-gray-300
                              file:mr-4 file:py-2 file:px-4
                              file:rounded-md file:border-0
                              file:text-sm file:font-semibold
                              file:bg-cyan-600 file:text-white
                              hover:file:bg-cyan-700 file:cursor-pointer
                              cursor-pointer border border-gray-600 rounded-md bg-gray-800">

                <div class="text-gray-500 text-sm">or</div>

                <div class="flex gap-2">
                    <input type="url" id="url-input" placeholder="Enter markdown URL..."
                           class="px-4 py-2 bg-gray-800 border border-gray-600 rounded-md text-gray-300 placeholder-gray-500 focus:outline-none focus:border-cyan-400 w-64">
                    <button id="load-url-btn"
                            class="px-4 py-2 bg-cyan-600 hover:bg-cyan-700 text-white rounded-md font-semibold transition-colors">
                        Load
                    </button>
                </div>
            </div>

            <div class="flex gap-2 justify-center flex-wrap">
                <button class="sample-btn px-3 py-1 bg-gray-700 hover:bg-gray-600 text-gray-300 rounded-md text-sm transition-colors"
                        data-url="https://raw.githubusercontent.com/adam-p/markdown-here/master/README.md">
                    Sample: Markdown Guide
                </button>
                <button class="sample-btn px-3 py-1 bg-gray-700 hover:bg-gray-600 text-gray-300 rounded-md text-sm transition-colors"
                        data-url="https://raw.githubusercontent.com/microsoft/vscode/main/README.md">
                    Sample: VS Code README
                </button>
            </div>
        </div>
    </header>

    <!-- Main Content Area -->
    <main class="mx-auto px-8 py-16" style="max-width: 73.33%; min-width: 800px;">

        <!-- Loading State -->
        <div id="loading-state" class="text-center hidden">
            <div class="loading-spinner"></div>
            <p class="text-gray-400">Loading document...</p>
        </div>

        <!-- Error State -->
        <div id="error-state" class="hidden">
            <div class="error-message">
                <h3 class="font-semibold mb-2">Error Loading Document</h3>
                <p id="error-message">An error occurred while loading the document.</p>
            </div>
        </div>

        <!-- Default Welcome Content -->
        <div id="welcome-content">
            <section class="mb-16">
                <h2 class="text-3xl font-semibold text-white mb-6">Welcome to the Markdown Reader</h2>
                <p class="text-gray-400 leading-relaxed mb-8 text-lg">
                    This dynamic document reader can load and beautifully render markdown files from multiple sources:
                </p>
                <ul class="list-disc list-inside space-y-3 text-gray-400 mb-8 text-lg">
                    <li><strong class="text-white">Local Files:</strong> Upload markdown files from your computer using the file picker above</li>
                    <li><strong class="text-white">Remote URLs:</strong> Load markdown content from any publicly accessible URL</li>
                    <li><strong class="text-white">Sample Documents:</strong> Try the sample buttons to see the reader in action</li>
                </ul>
                <div class="bg-gray-900 border border-gray-700 rounded-lg p-8 mt-8">
                    <h3 class="text-xl font-semibold text-cyan-400 mb-4">Features</h3>
                    <ul class="list-disc list-inside space-y-3 text-gray-300 text-lg">
                        <li>Beautiful syntax highlighting for code blocks</li>
                        <li>Responsive design that works on all devices</li>
                        <li>Dark theme optimized for reading</li>
                        <li>Support for all standard markdown features</li>
                        <li>Real-time document loading and parsing</li>
                    </ul>
                </div>
            </section>
        </div>

        <!-- Dynamic Content Area -->
        <div id="markdown-content" class="markdown-content hidden">
            <!-- Rendered markdown will be inserted here -->
        </div>

    </main>

    <script>
        class MarkdownReader {
            constructor() {
                this.initializeElements();
                this.setupEventListeners();
                this.updateTime();
                this.setupTimeUpdater();
            }

            initializeElements() {
                this.fileInput = document.getElementById('file-input');
                this.urlInput = document.getElementById('url-input');
                this.loadUrlBtn = document.getElementById('load-url-btn');
                this.sampleBtns = document.querySelectorAll('.sample-btn');

                this.loadingState = document.getElementById('loading-state');
                this.errorState = document.getElementById('error-state');
                this.welcomeContent = document.getElementById('welcome-content');
                this.markdownContent = document.getElementById('markdown-content');

                this.documentTitle = document.getElementById('document-title');
                this.documentSubtitle = document.getElementById('document-subtitle');
                this.pageTitle = document.getElementById('page-title');
                this.errorMessage = document.getElementById('error-message');
            }

            setupEventListeners() {
                this.fileInput.addEventListener('change', (e) => this.handleFileUpload(e));
                this.loadUrlBtn.addEventListener('click', () => this.handleUrlLoad());
                this.urlInput.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') this.handleUrlLoad();
                });

                this.sampleBtns.forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const url = e.target.dataset.url;
                        this.urlInput.value = url;
                        this.loadFromUrl(url);
                    });
                });
            }

            showLoading() {
                this.loadingState.classList.remove('hidden');
                this.errorState.classList.add('hidden');
                this.welcomeContent.classList.add('hidden');
                this.markdownContent.classList.add('hidden');
            }

            showError(message) {
                this.errorMessage.textContent = message;
                this.errorState.classList.remove('hidden');
                this.loadingState.classList.add('hidden');
                this.welcomeContent.classList.add('hidden');
                this.markdownContent.classList.add('hidden');
            }

            showContent() {
                this.markdownContent.classList.remove('hidden');
                this.loadingState.classList.add('hidden');
                this.errorState.classList.add('hidden');
                this.welcomeContent.classList.add('hidden');
            }

            showWelcome() {
                this.welcomeContent.classList.remove('hidden');
                this.loadingState.classList.add('hidden');
                this.errorState.classList.add('hidden');
                this.markdownContent.classList.add('hidden');

                this.documentTitle.textContent = 'Markdown Reader';
                this.documentSubtitle.textContent = 'Dynamic Document Renderer';
                this.pageTitle.textContent = 'Markdown Reader';
            }

            async handleFileUpload(event) {
                const file = event.target.files[0];
                if (!file) return;

                this.showLoading();

                try {
                    const content = await this.readFile(file);
                    this.renderMarkdown(content);
                    this.updateTitle(file.name);
                } catch (error) {
                    this.showError(`Failed to read file: ${error.message}`);
                }
            }

            readFile(file) {
                return new Promise((resolve, reject) => {
                    const reader = new FileReader();
                    reader.onload = (e) => resolve(e.target.result);
                    reader.onerror = (e) => reject(new Error('File reading failed'));
                    reader.readAsText(file);
                });
            }

            async handleUrlLoad() {
                const url = this.urlInput.value.trim();
                if (!url) return;

                await this.loadFromUrl(url);
            }

            async loadFromUrl(url) {
                this.showLoading();

                try {
                    const response = await fetch(url);
                    if (!response.ok) {
                        throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                    }

                    const content = await response.text();
                    this.renderMarkdown(content);

                    // Extract filename from URL for title
                    const urlParts = url.split('/');
                    const filename = urlParts[urlParts.length - 1] || 'Remote Document';
                    this.updateTitle(filename);

                } catch (error) {
                    this.showError(`Failed to load URL: ${error.message}`);
                }
            }

            renderMarkdown(content) {
                try {
                    // Configure marked options for better rendering
                    marked.setOptions({
                        breaks: true,
                        gfm: true,
                        smartLists: true,
                        smartypants: true,
                        headerIds: false,
                        mangle: false
                    });

                    // Parse the markdown
                    const html = marked.parse(content);

                    // Set the HTML content
                    this.markdownContent.innerHTML = html;

                    // Post-process the rendered HTML for better styling
                    this.enhanceRenderedContent();

                    this.showContent();

                    // Scroll to top smoothly
                    window.scrollTo({ top: 0, behavior: 'smooth' });

                } catch (error) {
                    this.showError(`Failed to render markdown: ${error.message}`);
                }
            }

            enhanceRenderedContent() {
                // Add syntax highlighting hints to code blocks
                const codeBlocks = this.markdownContent.querySelectorAll('pre code');
                codeBlocks.forEach(block => {
                    // Get the language from class if available
                    const classes = block.className.split(' ');
                    const langClass = classes.find(cls => cls.startsWith('language-'));
                    if (langClass) {
                        const lang = langClass.replace('language-', '');
                        // Create a header for the code block
                        const header = document.createElement('div');
                        header.className = 'code-block-header';
                        header.textContent = lang.toUpperCase();
                        block.parentNode.parentNode.insertBefore(header, block.parentNode);
                        block.parentNode.classList.add('has-header');
                    }
                });

                // Enhance tables with better styling
                const tables = this.markdownContent.querySelectorAll('table');
                tables.forEach(table => {
                    const wrapper = document.createElement('div');
                    wrapper.className = 'table-wrapper';
                    wrapper.style.overflowX = 'auto';
                    wrapper.style.marginBottom = '1.5rem';
                    table.parentNode.insertBefore(wrapper, table);
                    wrapper.appendChild(table);
                });

                // Add target="_blank" to external links
                const links = this.markdownContent.querySelectorAll('a[href^="http"]');
                links.forEach(link => {
                    link.target = '_blank';
                    link.rel = 'noopener noreferrer';
                });
            }

            updateTitle(filename) {
                const title = filename.replace(/\.(md|markdown|txt)$/i, '');
                this.documentTitle.textContent = title;
                this.documentSubtitle.textContent = 'Loaded Document';
                this.pageTitle.textContent = title;
            }

            updateTime() {
                const timeElement = document.getElementById('time-display');
                if (timeElement) {
                    const now = new Date();
                    const options = {
                        weekday: 'long',
                        year: 'numeric',
                        month: 'long',
                        day: 'numeric',
                        hour: 'numeric',
                        minute: 'numeric',
                        timeZone: 'Asia/Kolkata',
                        hour12: true,
                        timeZoneName: 'short'
                    };
                    timeElement.textContent = new Intl.DateTimeFormat('en-US', options).format(now);
                }
            }

            setupTimeUpdater() {
                // Update time every minute
                setInterval(() => this.updateTime(), 60000);
            }
        }

        // Initialize the application when DOM is loaded
        document.addEventListener('DOMContentLoaded', () => {
            new MarkdownReader();
        });
    </script>
</body>
</html>
